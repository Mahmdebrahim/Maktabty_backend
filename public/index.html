<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>üìö Kotoby - Your Online Bookstore</title>
    <link rel="stylesheet" href="styles.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
</head>
<body>
    <div id="app">
        <!-- Navigation -->
        <nav class="navbar">
            <div class="container">
                <div class="nav-brand">
                    <h1>üìö Kotoby</h1>
                </div>
                <div class="nav-menu">
                    <a href="#" onclick="app.showHome()">üè† Home</a>
                    <a href="#" onclick="app.showBooks()">üìñ Books</a>
                    <a href="#" onclick="app.showFavorites()">‚ù§Ô∏è Favorites</a>
                    <a href="#" onclick="app.showCart()">üõí Cart</a>
                    <a href="#" onclick="app.showProfile()" style="display: none" id="profileLink">üë§ Profile</a>
                    <div class="user-menu">
                        <span id="userDisplay">Guest</span>
                        <button id="authBtn" onclick="app.toggleAuthModal()">Login</button>
                        <button id="logoutBtn" style="display: none" onclick="app.logout()">Logout</button>
                        <button id="sellerBtn" style="display: none" onclick="app.showSellerPanel()" class="seller-btn">üìä Seller</button>
                        <button id="adminBtn" style="display: none" onclick="app.showAdminPanel()" class="admin-btn">‚öôÔ∏è Admin</button>
                    </div>
                </div>
            </div>
        </nav>

        <!-- Home Page -->
        <section id="home" class="page active">
            <div class="container">
                <div class="hero">
                    <h2>Welcome to Kotoby üìö</h2>
                    <p>Discover thousands of books from trusted sellers</p>
                    <button onclick="app.showBooks()" class="btn-primary">
                        Explore Books ‚Üí
                    </button>
                </div>
            </div>
        </section>

        <!-- Books Page -->
        <section id="books" class="page">
            <div class="container">
                <h2 style="margin-bottom: 1.5rem; color: var(--dark-text);">üìñ Browse Books</h2>

                <div class="filters-section">
                    <input type="text" id="searchInput" placeholder="üîç Search books..." onkeyup="app.filterBooks()" />
                    <select id="categoryFilter" onchange="app.onCategoryFilterChange()">
                        <option value="">All Categories</option>
                    </select>
                    <select id="subcategoryFilter" onchange="app.filterBooks()">
                        <option value="">All Sub Categories</option>
                    </select>
                    <input type="number" id="minPrice" placeholder="Min Price (EGP)" onchange="app.filterBooks()" />
                    <input type="number" id="maxPrice" placeholder="Max Price (EGP)" onchange="app.filterBooks()" />
                    <select id="conditionFilter" onchange="app.filterBooks()">
                        <option value="">All Conditions</option>
                        <option value="new">New</option>
                        <option value="exellant">Excellent</option>
                        <option value="very good">Very Good</option>
                        <option value="good">Good</option>
                        <option value="old">Old</option>
                    </select>
                </div>

                <div id="booksList" class="books-grid"></div>

                <div class="pagination">
                    <button onclick="app.previousPage()">‚Üê Previous</button>
                    <span id="pageInfo">Page 1</span>
                    <button onclick="app.nextPage()">Next ‚Üí</button>
                </div>
            </div>
        </section>

        <!-- Favorites Page -->
        <section id="favorites" class="page">
            <div class="container">
                <h2 style="margin-bottom: 1.5rem; color: var(--dark-text);">‚ù§Ô∏è My Favorites</h2>
                <div id="favoritesList" class="books-grid"></div>
            </div>
        </section>

        <!-- Cart Page -->
        <section id="cart" class="page">
            <div class="container">
                <h2 style="margin-bottom: 1.5rem; color: var(--dark-text);">üõí Shopping Cart</h2>
                <div class="cart-container">
                    <div class="cart-items">
                        <div id="cartItemsList"></div>
                    </div>
                    <div class="cart-summary">
                        <h3>Order Summary</h3>
                        <div class="summary-item">
                            <span>Subtotal:</span>
                            <span id="subtotal">EGP 0</span>
                        </div>
                        <div class="summary-item">
                            <span>Shipping:</span>
                            <span id="shippingCost">EGP 30</span>
                        </div>
                        <div class="summary-item total">
                            <span>Total:</span>
                            <span id="totalPrice">EGP 0</span>
                        </div>
                        <button onclick="app.showCheckout()" class="btn-primary">
                            Proceed to Checkout ‚Üí
                        </button>
                    </div>
                </div>
            </div>
        </section>

        <!-- Profile Page -->
        <section id="profile" class="page">
            <div class="container">
                <div class="profile-container">
                    <h2>üë§ My Profile</h2>
                    <div class="profile-tabs">
                        <button class="tab-btn active" onclick="app.switchProfileTab('info')">
                            üìã Profile Info
                        </button>
                        <button class="tab-btn" onclick="app.switchProfileTab('orders')">
                            üì¶ My Orders
                        </button>
                    </div>

                    <!-- Profile Info Tab -->
                    <div id="profileInfoTab" class="profile-tab-content active">
                        <div class="profile-content">
                            <div class="profile-card">
                                <div class="profile-header">
                                    <div class="profile-avatar">üë§</div>
                                    <h3 id="profileDisplayName">Loading...</h3>
                                </div>
                                <div id="profileDisplay" class="profile-display"></div>
                            </div>
                            <div class="profile-card">
                                <div class="edit-profile-section">
                                    <h3>‚úèÔ∏è Edit Your Information</h3>
                                    <form id="editProfileForm" onsubmit="app.handleUpdateProfile(event)">
                                        <div class="form-group">
                                            <label for="profileUsername">Username</label>
                                            <input type="text" id="profileUsername" placeholder="Enter your username" required />
                                        </div>
                                        <div class="form-group">
                                            <label for="profileEmail">Email</label>
                                            <input type="email" id="profileEmail" placeholder="Enter your email" required />
                                        </div>
                                        <div class="form-group">
                                            <label for="profilePhone">Phone</label>
                                            <input type="tel" id="profilePhone" placeholder="Enter your phone" required />
                                        </div>
                                        <div id="profileError" class="profile-error"></div>
                                        <div class="profile-form-actions">
                                            <button type="submit" class="save-profile-btn">üíæ Save Changes</button>
                                            <button type="reset" class="cancel-profile-btn" onclick="app.loadProfile()">Cancel</button>
                                        </div>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- My Orders Tab -->
                    <div id="profileOrdersTab" class="profile-tab-content">
                        <div id="userOrdersList" class="orders-list"></div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Seller Panel -->
        <section id="sellerPanel" class="page">
            <div class="container">
                <h2 style="margin-bottom: 1.5rem; color: var(--dark-text);">üìä Seller Dashboard</h2>
                <div class="seller-tabs">
                    <button class="tab-btn active" onclick="app.switchSellerTab('myBooks')">
                        üìö My Books
                    </button>
                    <button class="tab-btn" onclick="app.switchSellerTab('addBook')">
                        ‚ûï Add Book
                    </button>
                    <button class="tab-btn" onclick="app.switchSellerTab('mySales')">
                        üí∞ My Sales
                    </button>
                </div>

                <!-- My Books Tab -->
                <div id="myBooksTab" class="tab-content active">
                    <div id="myBooksList" class="books-grid"></div>
                </div>

                <!-- Add Book Tab -->
                <div id="addBookTab" class="tab-content">
                    <form id="addBookForm" class="form-container">
                        <input type="text" id="bookTitle" placeholder="Book Title *" required />
                        <input type="text" id="bookAuthors" placeholder="Authors (comma separated) *" required />
                        <input type="number" id="bookYear" placeholder="Published Year *" required />
                        <input type="number" id="bookPrice" placeholder="Price (EGP) *" required min="0" step="0.01" />
                        <input type="number" id="bookQuantity" placeholder="Quantity *" required min="1" />
                        <textarea id="bookDescription" placeholder="Description" rows="4"></textarea>
                        <select id="bookCategory" onchange="app.onCategoryChange()" required>
                            <option value="">Select Category *</option>
                        </select>
                        <select id="bookSubCategory">
                            <option value="">Select Sub Category (Optional)</option>
                        </select>
                        <select id="bookCondition" required>
                            <option value="">Select Condition *</option>
                            <option value="new">New</option>
                            <option value="exellant">Excellent</option>
                            <option value="very good">Very Good</option>
                            <option value="good">Good</option>
                            <option value="old">Old</option>
                        </select>
                        <input type="text" id="bookImages" placeholder="Image URL" />
                        <button type="submit" class="btn-primary">Add Book</button>
                    </form>
                </div>

                <!-- My Sales Tab -->
                <div id="mySalesTab" class="tab-content">
                    <div id="mySalesList"></div>
                </div>
            </div>
        </section>

        <!-- Admin Panel -->
        <section id="adminPanel" class="page">
            <div class="container">
                <h2 style="margin-bottom: 1.5rem; color: var(--dark-text);">‚öôÔ∏è Admin Dashboard</h2>
                <div class="admin-tabs">
                    <button class="tab-btn active" onclick="app.switchAdminTab('users')">
                        üë• Users
                    </button>
                    <button class="tab-btn" onclick="app.switchAdminTab('books')">
                        üìö All Books
                    </button>
                    <button class="tab-btn" onclick="app.switchAdminTab('orders')">
                        üì¶ All Orders
                    </button>
                    <button class="tab-btn" onclick="app.switchAdminTab('categories')">
                        üè∑Ô∏è Categories
                    </button>
                </div>

                <!-- Users Tab -->
                <div id="usersTab" class="tab-content active">
                    <div id="usersList" class="admin-table"></div>
                </div>

                <!-- Books Tab -->
                <div id="booksTab" class="tab-content">
                    <div id="adminBooksList" class="admin-table"></div>
                </div>

                <!-- Orders Tab -->
                <div id="ordersTab" class="tab-content">
                    <div id="adminOrdersList" class="admin-table"></div>
                </div>

                <!-- Categories Tab -->
                <div id="categoriesTab" class="tab-content">
                    <div class="add-category-form">
                        <input type="text" id="categoryName" placeholder="Category Name" />
                        <select id="categoryParent">
                            <option value="">Parent Category (optional)</option>
                        </select>
                        <button onclick="app.addCategory()" class="btn-primary">Add Category</button>
                    </div>
                    <div id="categoriesList" class="categories-tree"></div>
                </div>
            </div>
        </section>

        <!-- Book Detail Modal -->
        <div id="bookModal" class="modal">
            <div class="modal-content">
                <button class="modal-close" onclick="app.closeModal()">&times;</button>
                <div id="bookDetail" class="book-detail"></div>
            </div>
        </div>

        <!-- Auth Modal -->
        <div id="authModal" class="modal">
            <div class="modal-content" style="max-width: 480px;">
                <button class="modal-close" onclick="app.closeAuthModal()">&times;</button>
                <div class="auth-container">
                    <div class="auth-tabs">
                        <button class="auth-tab-btn active" onclick="app.switchAuthTab('login')">
                            Login
                        </button>
                        <button class="auth-tab-btn" onclick="app.switchAuthTab('register')">
                            Register
                        </button>
                    </div>

                    <!-- Login Form -->
                    <div id="loginForm" class="auth-form active">
                        <form onsubmit="app.handleLogin(event)">
                            <input type="email" id="loginEmail" placeholder="Email Address" required />
                            <input type="password" id="loginPassword" placeholder="Password" required />
                            <button type="submit" class="btn-primary">Login</button>
                            <div id="loginError" class="error-message"></div>
                        </form>
                    </div>

                    <!-- Register Form -->
                    <div id="registerForm" class="auth-form">
                        <form onsubmit="app.handleRegister(event)">
                            <input type="text" id="registerUsername" placeholder="Username" required />
                            <input type="email" id="registerEmail" placeholder="Email Address" required />
                            <input type="password" id="registerPassword" placeholder="Password" required />
                            <input type="tel" id="registerPhone" placeholder="Phone (01XXXXXXXXX)" required />
                            <select id="registerRole">
                                <option value="user">Customer</option>
                                <option value="seller">Seller</option>
                            </select>
                            <button type="submit" class="btn-primary">Register</button>
                            <div id="registerError" class="error-message"></div>
                        </form>
                    </div>
                </div>
            </div>
        </div>

        <!-- Checkout Modal -->
        <div id="checkoutModal" class="modal">
            <div class="modal-content" style="max-width: 560px;">
                <button class="modal-close" onclick="app.closeCheckout()">&times;</button>
                <div class="checkout-container">
                    <h2>üõí Checkout</h2>
                    <form onsubmit="app.processOrder(event)">
                        <h3>üìç Shipping Address</h3>
                        <input type="text" id="fullname" placeholder="Full Name *" required />
                        <input type="tel" id="phone" placeholder="Phone Number *" required />
                        <input type="text" id="address" placeholder="Address *" required />
                        <input type="text" id="city" placeholder="City *" required />

                        <h3>üí≥ Payment Method</h3>
                        <select id="paymentMethod" required>
                            <option value="">Select Payment Method *</option>
                            <option value="cash">üíµ Cash on Delivery</option>
                            <option value="card">üí≥ Credit Card</option>
                            <option value="online">üåê Online Payment</option>
                            <option value="wallet">üëõ Wallet</option>
                        </select>

                        <div class="order-summary">
                            <p>Total Amount: <strong id="checkoutTotal">EGP 0</strong></p>
                        </div>

                        <button type="submit" class="btn-primary">Place Order ‚Üí</button>
                        <div id="checkoutError" class="error-message"></div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Order Details Modal -->
        <div id="orderDetailsModal" class="modal">
            <div class="modal-content modal-wide">
                <button class="modal-close" onclick="app.closeOrderDetails()">&times;</button>
                <div id="orderDetailsContent" class="order-details-content"></div>
            </div>
        </div>

        <!-- Payment Modals -->
        <!-- Cash on Delivery -->
        <div id="cashPaymentModal" class="modal">
            <div class="modal-content payment-modal">
                <button class="modal-close" onclick="app.closePaymentModal()">&times;</button>
                <div class="payment-container">
                    <div class="payment-icon">üíµ</div>
                    <h2>Cash on Delivery</h2>
                    <p class="payment-description">Pay when your order arrives</p>
                    <div class="payment-info">
                        <p>üöö Driver will collect payment from you</p>
                        <p>‚úì No additional fees</p>
                        <p>‚úì Verify items before payment</p>
                    </div>
                    <button onclick="app.processPaymentSimulation('cash')" class="btn-primary payment-btn">
                        Confirm Order
                    </button>
                </div>
            </div>
        </div>

        <!-- Credit Card -->
        <div id="cardPaymentModal" class="modal">
            <div class="modal-content payment-modal">
                <button class="modal-close" onclick="app.closePaymentModal()">&times;</button>
                <div class="payment-container">
                    <div class="payment-icon">üí≥</div>
                    <h2>Credit Card Payment</h2>
                    <form onsubmit="app.processCardPayment(event)">
                        <div class="card-container">
                            <input type="text" id="cardNumber" placeholder="Card Number" maxlength="19" required />
                            <div class="card-row">
                                <input type="text" id="cardExpiry" placeholder="MM/YY" maxlength="5" required />
                                <input type="text" id="cardCvv" placeholder="CVV" maxlength="3" required />
                            </div>
                            <input type="text" id="cardHolder" placeholder="Cardholder Name" required />
                        </div>
                        <button type="submit" class="btn-primary payment-btn">Process Payment</button>
                    </form>
                </div>
            </div>
        </div>

        <!-- Online Payment -->
        <div id="onlinePaymentModal" class="modal">
            <div class="modal-content payment-modal">
                <button class="modal-close" onclick="app.closePaymentModal()">&times;</button>
                <div class="payment-container">
                    <div class="payment-icon">üåê</div>
                    <h2>Online Payment Gateway</h2>
                    <p class="payment-description">Choose your payment method</p>
                    <div class="payment-methods-grid">
                        <button class="payment-method-card" onclick="app.processPaymentSimulation('fawry')">
                            <div class="method-icon">üè¶</div>
                            <div>Fawry</div>
                        </button>
                        <button class="payment-method-card" onclick="app.processPaymentSimulation('payfort')">
                            <div class="method-icon">üõ°Ô∏è</div>
                            <div>PayFort</div>
                        </button>
                        <button class="payment-method-card" onclick="app.processPaymentSimulation('stripe')">
                            <div class="method-icon">‚ö°</div>
                            <div>Stripe</div>
                        </button>
                        <button class="payment-method-card" onclick="app.processPaymentSimulation('paypal')">
                            <div class="method-icon">üÖøÔ∏è</div>
                            <div>PayPal</div>
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Wallet Payment -->
        <div id="walletPaymentModal" class="modal">
            <div class="modal-content payment-modal">
                <button class="modal-close" onclick="app.closePaymentModal()">&times;</button>
                <div class="payment-container">
                    <div class="payment-icon">üëõ</div>
                    <h2>Wallet Payment</h2>
                    <div class="wallet-info">
                        <p>üí∞ Your Wallet Balance</p>
                        <div class="wallet-balance" id="walletBalance">EGP 0</div>
                    </div>
                    <div id="walletMessage" class="wallet-message"></div>
                    <button id="confirmWalletBtn" onclick="app.processPaymentSimulation('wallet')" class="btn-primary payment-btn">
                        Pay from Wallet
                    </button>
                </div>
            </div>
        </div>

        <!-- Payment Success -->
        <div id="paymentSuccessModal" class="modal">
            <div class="modal-content payment-modal">
                <div class="payment-container success">
                    <div class="payment-icon success-icon">‚úÖ</div>
                    <h2>Payment Successful!</h2>
                    <p class="payment-description">Your order has been confirmed</p>
                    <div class="order-confirmation">
                        <p id="confirmationMessage"></p>
                        <p id="confirmationDetails"></p>
                    </div>
                    <button onclick="app.completePaymentProcess()" class="btn-primary payment-btn">
                        Continue Shopping
                    </button>
                </div>
            </div>
        </div>

        <!-- Loader -->
        <div id="loader" class="loader" style="display: none"></div>

        <!-- Notification -->
        <div id="notification" class="notification"></div>
    </div>

    <script src="app.js"></script>
</body>
</html>